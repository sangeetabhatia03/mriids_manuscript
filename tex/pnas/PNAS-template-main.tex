\documentclass[9pt,twocolumn,twoside,lineno]{pnas-new}
% Use the lineno option to display guide line numbers if required.


\templatetype{pnasresearcharticle} % Choose template 
% {pnasresearcharticle} = Template for a two-column research article
% {pnasmathematics} %= Template for a one-column mathematics article
% {pnasinvited} %= Template for a PNAS invited submission
\newcommand{\sangeeta}[1]{\textcolor{blue}{#1}}
% Added to be able to reference figures across SI.
\usepackage{xr}
\makeatletter
\long\def\XR@test#1#2#3#4\XR@{%
  \let\XR@next\@gobbletwo
  \ifx#1\newlabel
    \let\XR@next\@firstoftwo%
  \else\ifx#1\@input
     \let\XR@next\@secondoftwo
  \fi\fi
   \XR@next{\newlabel{\XR@prefix#2}{#3}}{\edef\XR@list{\XR@list#2\relax}}%
  \ifeof\@inputcheck\expandafter\XR@aux
  \else\expandafter\XR@read\fi}
\makeatother
\externaldocument{SI}

\title{Using Digital Surveillance Tools for Near Real-Time Mapping of
  the Risk of International Infectious Disease Spread: Ebola as a Case Study}

% Use letters for affiliations, numbers to show equal authorship (if applicable) and to indicate the corresponding author
\author[2, a]{Sangeeta Bhatia}
\author[b]{Britta Lassmann} 
\author[c]{Emily Cohn}
\author[b, d]{Malwina Carrion}
\author[e]{Moritz Kraemer}
\author[f]{Mark Herringer}
\author[c]{John Brownstein}
\author[b]{Larry Madoff}
\author[1, a]{Anne Cori}
\author[1, g]{Pierre Nouvellet}
\affil[a]{MRC Centre for Global Infectious Disease Analysis, Imperial College London,
  Praed St London UK}
\affil[b]{ProMED, International Society for Infectious Diseases,
  Brookline, MA 02446 USA}
\affil[c]{Computational Epidemiology Group, Division of Emergency
  Medicine, Boston Children’s Hospital, Boston, MA USA}
\affil[e]{Spatial Ecology and Epidemiology Group, Tinbergen Building, Department of Zoology, Oxford University, Oxford, UK}
\affil[f]{healthsites.io}
\affil[g]{Evolution, Behaviour and Environment, University of Sussex,
  Brighton, UK}
\affil[d]{Department of Health Science, Sargent College, Boston
  University, Boston, MA USA}
% Please give the surname of the lead author for the running footer
\leadauthor{Bhatia} 

% Please add here a significance statement to explain the relevance of your work
\significancestatement{
Predicting in real-time the short-term dynamics of an outbreak is
critical to plan and implement adequate interventions. For example,
during an outbreak, it is important to predict which countries or regions 
will be affected next. This can be challenging because of delays in
data collection and publication. Here we show
how publicly available data from ProMED and HealthMap, the two
leading and pioneering internet-based disease surveillance platforms,
could have been used in real-time to accurately predict
the international spread of Ebola during 
the 2013-2016 West African epidemic.
Our work provides novel and crucial evidence about the reliability of
ProMED and HealthMap data, especially when used during an outbreak.
}

% Please include corresponding author, author contribution and author declaration information
\authorcontributions{Please provide details of author contributions here.}
\authordeclaration{Please declare any conflict of interest here.}
\equalauthors{\textsuperscript{1}AC (Anne Cori) and PN (Pierre Nouvellet) contributed equally to this work.}
\correspondingauthor{\textsuperscript{2}To whom correspondence should be addressed. E-mail: s.bhatia@imperial.ac.uk}

% Keywords are not mandatory, but authors are strongly encouraged to provide them. If provided, please include two to five keywords, separated by the pipe symbol, e.g:
\keywords{outbreaks $|$ forecasting 2 $|$ digital digital disease surveillance 3 $|$} 

\begin{abstract}
  In our increasingly interconnected world, it is crucial to understand
  the risk of an outbreak originating in one country or region and
  spreading to the rest of the world. Digital disease surveillance
  tools such as ProMED and HealthMap have the potential to serve as
  important early warning systems as well as complement the field
  surveillance during an ongoing outbreak. Here we present a flexible
  statistical model that uses data produced from digital surveillance
  tools (ProMED and HealthMap) to forecast short term incidence trend
  in a spatially explicit manner. The model was
  applied to data collected by ProMED and HealthMap during the
  2013-2016 West African Ebola epidemic. The model was able to
  predict each instance of international spread 1 to 4 weeks in
  advance. Our study highlights the potential and limitations of using
  publicly available 
  digital surveillance data for assessing outbreak dynamics in real-time.
\end{abstract}

\dates{This manuscript was compiled on \today}
\doi{\url{www.pnas.org/cgi/doi/10.1073/pnas.XXXXXXXXXX}}

\begin{document}

\maketitle
\thispagestyle{firststyle}
\ifthenelse{\boolean{shortarticle}}{\ifthenelse{\boolean{singlecolumn}}{\abscontentformatted}{\abscontent}}{}

% If your first paragraph (i.e. with the \dropcap) contains a list environment (quote, quotation, theorem, definition, enumerate, itemize...), the line after the list may have some extra indentation. If this is the case, add \parshape=0 to the end of the list environment.

Increasing globalization of commerce, finance, production, and services
has fostered rapid movement of people, animals, plants, food, and
feed \cite{morse2001factors}. With the transportation of people and
goods comes the widespread dispersion of pathogens that cause infectious
diseases and the vectors that may spread them. Outbreaks that begin in
the most remote parts of the world can now spread swiftly to urban
centers and to countries far away with dangerous, global consequences
\cite{ex1995communicable}. For instance, population mobility across
borders played a critical role in the spread of Ebola \sangeeta{virus} in West Africa
during the 2013-2016 Ebola epidemic \cite{ebfactors}. A more recent
example is the 2016 \sangeeta{y}ellow Fever outbreak in Angola. Infected travellers
from Angola reached China, representing the first ever reported cases of
\sangeeta{y}ellow fever in Asia \cite{wasserman2016yellow}.

Early detection and \sangeeta{monitoring} of infectious disease outbreaks through passive or
active collection of surveillance data can help public health officials
initiate interventions such as removing contaminated food sources,
isolating affected individuals or launching vaccination campaigns.
However, any data collection method involves trade-offs between speed,
accuracy and costs. Data collected through \sangeeta{traditional} surveillance,
\sangeeta{for example via} public health infrastructure, are generally reliable but
are resource intensive and are therefore typically available for
upstream analysis with an (understandable) delay.

The rapid growth of the internet has fostered a corresponding increase
in tools for internet based disease detection \sangeeta{ and monitoring} 
that lie at the other end
of the spectrum. Digital disease surveillance consists of monitoring
online information sources to collate relevant information about
diseases. The sources of information \sangeeta{can} be formal such as advisories
posted by a ministry of health, or informal such as \sangeeta{news media
  items}, blogs or tweets.
Digital surveillance makes data collection less expensive and time
consuming but the acquired data often \sangeeta{contain more noise} than those
collected through \sangeeta{traditional public health} surveillance. \sangeeta{While traditional
  surveillance systems report on select pathogens and depend on a
  well-functioning public health infrastructure, digital surveillance
  in contrast typically monitor a wide range of pathogens using little
to no additional infrastructure.} Thus, digital surveillance tools
can play a significant role in the rapid recognition of public health
emergencies \cite{grein2000rumors, anema2014digital}.

The Program for Monitoring Emerging Diseases (ProMED,
www.promedmail.org) was one of the first entrants in the field of
digital disease \sangeeta{surveillance}. ProMED was created in 1994 as a surveillance
network to provide early warning of emerging \sangeeta{and re-emerging}
infections \cite{morse2012public}. ProMED collates information from
various sources that include media reports, official reports, local
observers, and a network of clinicians throughout the world. The reports
generated through bottom-up surveillance are reviewed by a team of
subject matter experts before being posted to \sangeeta{the} ProMED network. ProMED now
provides free email based reports on outbreaks to over 70,000
subscribers in at least 185 countries.

HealthMap (www.healthmap.org) is another widely used tool for disease
outbreak monitoring. In addition to ProMED alerts, HealthMap utilises
online news aggregators, eyewitness reports and other formal and
informal sources of information and allows for visualisation of alerts
on a map \cite{freifeld2008healthmap}. 
The surveillance data collected by HealthMap  has been incorporated into the Epidemic
Intelligence from Open Sources (EIOS) surveillance system, developed
by WHO. \sangeeta{Both ProMED and} HealthMap
is used by key public health bodies, including the Centers for Disease
Control and Prevention (CDC) and the World Health Organisation (WHO).

Some other examples of digital disease detection tools include MediSys
(http://medisys.newsbrief.eu/), H5N1 Google Earth mashup
(www.nature.com/avianflu/google-earth), and Emerging Infections Network
(http://ein.idsociety.org). These tools provide a unique opportunity to
rapidly detect new outbreaks and follow their evolution in near
real-time.

Collating timely data, while critical, is only the first step in the
disease surveillance process. Compiling the data, conducting analysis,
and generating reports that are easily understood and actionable are
equally important. For instance, \sangeeta{one of the ProMED subject matter experts
 reported in March 2014 on the likely spread of Zika to the Americas 
\cite{promedzika}, well before the epidemic surfaced in South
America in February 2015.} However, lacking an easy to use and openly
accessible tool to quantify and visualize the \sangeeta{reported risk of
  disease spread}, this report did not have any significant impact on public health resource
allocation and decision making. While there has been a growing interest
in using various internet data streams for epidemiological
investigations \cite{generous2014global, milinovich2015role} and
in using data from digital surveillance tools
\cite{chowell2016elucidating}, there is as yet a dearth of a framework
that can automatically combine such data with other streams of
information, analyse them in a statistically robust manner, and produce
actionable reports, particularly in real time during an outbreak where
such analyses would be most useful.

In this study, we propose a new statistical framework to estimate and
visualize risks posed by outbreak events using digital surveillance
data. Our approach relies on a relatively simple statistical framework
that integrates multiple data streams to predict the future incidence
trajectory, and \sangeeta{quantifies} spatial heterogeneity in the risk of disease
spread. In this paper, we present the model implemented in this \sangeeta{framework}
and as a case study, we report the analysis of ProMED and HealthMap data
for the 2013-16 West African Ebola epidemic. To assess the robustness of
the digital surveillance data, we also applied the framework to the data
collated by WHO and made available at
the end of the epidemic. We present a comparison of the near real-time
ProMED/HealthMap data with the retrospective WHO data and the results of
the spatio-temporal analysis carried out on these three data sources.

Our analysis based solely on epidemic data available through
ProMED/HealthMap provides a realistic appraisal of their strengths and
weaknesses, especially if used in near real-time forecasting.

\section*{Results}

Incidence time series were computed from ProMED, HealthMap and WHO data
(see Methods) for the three mainly affected countries, Guinea,
Liberia and Sierra Leone, and are shown in Figure 1. The raw and
processed (see Methods) data from ProMED and HealthMap for all countries
included in the feed are available in the Github repository for this
article. There were
substantial differences between the incidence time series derived from
the three data sources, particularly at the peak of the epidemic. There
may be multiple reasons underpinning such discrepancy, including
potential variability in digital surveillance reporting during the
course of the epidemic. It is also worth highlighting that the WHO data
used here are an extensively cleaned version of the data collected
during the epidemic \cite{who2014ebola, team2015west}, published
more than a year after the epidemic was declared to be over. However,
despite these discrepancies, the weekly incidence derived from ProMED
and HealthMap was moderately to highly correlated with that reported by
WHO later (Pearson's correlation coefficients aggregated across the
three countries 0.44 and 0.74 respectively, p value \textless{} 0.001,
also see SI Fig~\ref{fig:weekly} for weekly trends).

To broadly assess the extent to which such discrepancies in incidence
would impact the quantification of transmissibility throughout the
epidemic, we estimated the time-varying transmissibility, measured by
the reproduction number \(R^t\) (the average number of secondary cases
infected by each individual infected at time \(t\)), using the incidence
from each of the three data sources (Figure 1). \(R^t\) was estimated
independently for each country using the R package EpiEstim
\cite{cori2013new} over a sliding time window of 4 weeks. There were
substantial differences in the estimates of \(R^t\) according to the
incidence data source used (Figure 1B). The correlation between the
median $R^t$ estimates on sliding 4-week windows from ProMED or HealthMap
data with the estimates from WHO data varied from weak (0.30, between
reproduction number from WHO and ProMED in Guinea) to very strong
(0.72, between reproduction number from WHO and \sangeeta{ProMED} in Sierra
Leone, SI Fig~\ref{fig:rcorr}).

Since HealthMap uses ProMED alerts in addition to other online data
sources, ProMED represents the more conservative data source between the
two. Therefore we present the results based on ProMED data in the main
text, unless otherwise \sangeeta{specified}. The analysis based on HealthMap and
WHO data are presented in the
Supplementary Information (SI) (SI Sections \ref{sec:hm}
and \ref{sec:who}).


\subsection*{Short term forecasts}\label{short-term-forecasts}

To forecast incidence at time \(t\) in location \(j\) (\(I_{j}^{t}\)),
we fitted a spatially explicit branching process model to the daily
incidence in all locations up to \(t - 1\), using an extension of the
renewal equation as the likelihood \cite{fraser2007estimating}:

\begin{equation}
I_{j}^{t} \sim Poisson\left(\sum_{i = 1}^n\left({p_{i \rightarrow j} R_{i}^{t}
\sum_{s = 1}^t{I_{i}^{t - s} \omega_s}}\right)\right)
\label{eq:model}
\end{equation}

where the matrix \(p_{i \rightarrow j}\) characterises the spatial
spread between locations \(i\) and \(j\) based on a gravity model
\cite{zipf1946p}, \(R_{i}^{t}\) (the reproduction number) reflects
transmissibility in location \(i\) at time \(t\), and \(\omega\) is the
typical infectiousness profile of a case over time after infection (see
Methods for details).

The ability of the model to robustly predict future outbreak
trajectory was limited and depended on the data source (Fig \ref{fig:pm24})
as well as on the time window used for inference (calibration window)
and the forecast horizon. Results using a 2-week calibration window
and a 4-week forecast horizon using ProMED data are presented in
the main text (see SI Figs \ref{fig:pm26} and \ref{fig:pm28} for other 
forecast horizons and calibration windows).
Overall, 48.7\% of weekly observed incidence across
all three countries were included in the 95\%
forecast interval (49.3\% and 57.5\% for HealthMap and WHO
respectively, SI Table \ref{tab:propinci}).
Typically, model forecasts were 0.5 times lower or higher
than the observed incidence (95\% CrI 0.0 - 32.0) based on the 
median relative mean absolute
error (Fig \ref{fig:perfpm24}D), see Methods for details). We found no evidence of
systematic bias in any week of the forecast horizon (median bias 0.12,
Fig \ref{fig:perfpm24}A).



% To further assess the
% potential tendency of our model to systematically under- or over-predict
% observations, we used a measure of bias ranging from -1 for a model
% which always under-predicts, to 1 for a model which always over-predicts
% (see Methods). The mean bias over the forecast horizon was 0.077 (IQR
% -0.93 - 0.98) indicating 

Typically, individual forecasts were within 17.0\% (95\% CrI 0 - 80\%)
of the median forecast (based on the median and 95\% CrI for
relative sharpness, Fig \ref{fig:perfpm24}B, see Methods for details).

As expected, the robustness of forecasts (both accuracy and precision)
decreased over the forecast
horizon (Fig \ref{fig:perfpm24}C). In the first week of the forecast window, 58.0\% of
observed values (across the three countries) were within the 95\%
forecasts interval, reducing to 49.4\%, 42.3\% and 45.0\% in the
second, third and fourth weeks of the forecast horizon. 


% The mean value of the relative mean absolute error
% in the first week of the forecast horizon was 1.32 (Inter Quartile
% Range, IQR: 0.18 - 0.68), suggesting that on average our central
% one-week ahead predictions were about a third off either way of the
% observations. The mean bias for one-week ahead projections was 0.07 (IQR
% -0.81 - 0.94) indicating little systematic bias. The mean sharpness in
% the first week of the forecast horizon is 0.13 (IQR 0.05 - 0.15) meaning
% that on average our individual projected one-week ahead epidemic
% trajectories are within 13\% of the median projection.

%  Similarly, the mean relative error
% increases up to 10.02 (IQR 0.32 - 2.19) in week 4, the mean bias up to
% 0.08 (IQR -0.53 - 0.94) and the mean sharpness up to 0.17 (IQR 0.07 -
% 0.24).

The model performance varied depending on the
phase of the epidemic, defined as ``growing'', ``declining'', and 
``stable'' depending on $R^t$ estimates (see Methods). In
general, the model performance was best in the stable phase with
66.7\% of the observations contained in the 95\% forecasts interval
(versus 40.2\% and 30.8\% in the declining and growing phases respectively,
SI Table \ref{tab:propinci}). However the forecast uncertainty was largest in the stable
phase and smallest in the growing phase (Fig \ref{fig:perfpm24}B).
Importantly, in the growing phase the model tended to over-predict
while under-predicting in the declining phase (Fig \ref{fig:perfpm24}A).

% Fitting the model with alternative calibration windows 
% modifies the model complexity as the number of non-overlapping time
% windows, and thus parameters, over the course of the epidemic increases
% with shorter time windows.
Overall, the model performed moderately better using WHO data compared
to ProMED and HealthMap data (SI Fig \ref{fig:perfds}) \sangeeta{and with shorter 
calibration windows} (SI Fig \ref{fig:perftw}).

\subsection*{Risk of spatial spread}
Although our model was not always able to robustly predict the future
incidence in the three mainly affected countries, we found that it
allowed to robustly predict the
presence or absence of cases in all countries up to a week in
advance. For each week and each country in \sangeeta{Africa}, our model
generated an alert if the predicted incidence (using a predetermined
percentile of the forecast interval) was greater than 0. We classified
an alert for a given week as a true
alert when the observed incidence was also greater than 0, as a false
alert when no cases were observed, and as a missed alert if cases were
observed but were not predicted by the model. Using different
percentiles of the forecast (e.g., the median or the
95\textsuperscript{th} percentile)
yielded different rates of true, false and missed alerts, \sangeeta{which} were
summarised in a ROC curve (Fig \ref{fig:alerts}A). Overall, our model 
achieved high sensitivity but variable specificity \sangeeta{with} higher
percentiles as cut-off \sangeeta{yielding} increased sensitivity but poorer
specificity. Maximising the average between
sensitivity and specificity led to \sangeeta{95.9\%} sensitivity and 
\sangeeta{98.0\%} specificity at \sangeeta{50\% threshold}. \sangeeta{The
sensitivity of the model remained high over longer forecast horizon 
while the specificity deteriorated \ref{fig:alerts}A with more false alerts being raised
4 week ahead \ref{fig:alerts4weekahead}. At the same
threshold, the model attained poor sensitivity (42.9\%) but high
specificity (98\%) when all countries in Africa other than
the three majorly affected countries (Guinea, Liberia and Sierra
Leone) were considered \ref{fig:alertsallbut3}. 
Again, at 50\% threshold, the model exhibited 
high specificity (98.0\%) but poor sensitivity (42.9\%) in predicting 
presence of cases in weeks following a week with no observed cases in each
country \ref{fig:rocnocases}. In both cases, higher sensitivity with a reasonably high
specificity was achieved by increasing the cut-off at which an alert
is raised \ref{fig:tprbythreshold}.} The cut-off for raising an alert 
can thus be chosen based
on the relative costs of missed and false alerts \sangeeta{potentially
using a higher cut-off when the observed incidence is low.}

% For instance, in May 2014, the model \sangeeta{correctly predicted} the
% presence of cases in Liberia after three consecutive weeks with no
% observed incidence (\ref{fig:alerts}B). No false alerts were raised
% for any of these countries (Liberia, Sierra Leone, Nigeria, Senegal
% and Mali) and the model sensitivity ranged from 11.4\%
% (using 2.5th percentile) to 93.2\% (97.5th percentile). 

The high sensitivity of the model suggests that the model is able to
capture and even anticipate the spatial spread of the epidemic. 
\sangeeta{ Importantly, as the model is fit to data accumulating over
the course of the epidemic, it is able to predict the presence of
cases with a high degree of sensitivity and specificity relatively 
early in the epidemic \ref{fig:tprovertime} 
when such inputs would be particularly useful.}

Together with providing operational outputs such as the predicted
short-term incidence in currently affected countries or the risk of
spread to neighbouring countries, our method also provides near
real-time estimates of parameters underlying the transmission model.
First, the reproduction number \(R_t\) for each affected country is
estimated over the time-window of inference, here over the most recent
two weeks (Fig 2, second row). We found that these near real-time
estimates of \(R_t\) were in good agreement with retrospective estimates
obtained using the entire incidence time-series (Fig 2, bottom row,
correlation coefficients varying between 0.93 and 0.99 for the three
countries, SI Table \ref{tab:rcorr}).

The risk of spatial spread in our model relies on estimating movement
\sangeeta{patterns} of infectious cases. Our method also provides estimates of
%parameters of the underlying gravity model (see Methods), \(p_{stay}\),
the probability of a case staying within a country throughout their
infectious period, and  the extent to which
distance between two locations affects the flow between them. The
real-time estimates of these parameters over the course of the
epidemic (SI Fig \ref{fig:parsul2}), suggest that while the relative flow
between locations did not vary substantially over time, the probability
of travel across national borders may have decreased after the initial
phase of the epidemic.
% Figure 6 also illustrates how accumulating data
% throughout the course of the epidemic allows estimating such parameters
% more precisely.

Finally, we quantify the relative risk of importation of a case into a
country from any other currently affected country. The risk of
importation is proportional to the population flow into a country from
all other countries estimated using a mobility model (here, gravity
model) weighted by the infectivity at each country (see Methods). Our
estimates of the countries with higher risk of acting as source of
importations are largely consistent with the reported source of cases
(Fig \ref{fig:imprisk}). In 4 out of the 5 reported cases of international spread
of the epidemic in West Africa, the model correctly attributed a high relative
risk of acting as a source of importation to the actual source
identified through retrospective epidemiological and genomic
investigations \cite{gire2014genomic}.

% According to "retrspective" investigations
% 

\section*{Discussion}\label{discussion}

In the context of increasing potential for movement of diseases between
various regions of the world due to increased global connectivity,
innovative strategies for epidemic monitoring are urgently needed. In
this study, we propose a statistical framework that relies on digital
surveillance data from ProMED or HealthMap to 1) predict the short-term
epidemic trajectory in currently affected countries, 2) quantify the
short-term risk of spread to other countries and 3) for countries at
risk \sangeeta{of importation}, quantifies where the risk comes from. We apply our model to data
collected during the West African Ebola epidemic of 2013-2016, curated
by the \sangeeta{outbreak analysts} at ProMED/HealthMap, and we compare the model's output
to those obtained when using the data collated by the WHO and made
available at the end of the epidemic.

In spite of the manual curation of the data carried out by
\sangeeta{outbreak analysts} at ProMED and HealthMap, substantial issues remained in
the quality and consistency of the data feeds. Dealing with issues such
as missing data and inconsistent records will be a key challenge in
using these data for prospective real-time analysis. Despite these
challenges, we show the potential of digital surveillance tools to
1) \sangeeta{inform} early detection , 2) characterise the spread, and 3) forecast
the future trajectory of outbreaks. Particularly in an evolving outbreak
scenario, when information from traditional surveillance is limited and
only available with a significant delay, digital surveillance data \sangeeta{can}
be used to complement the information gap. For instance, during the West
African Ebola epidemic, the first situation report by the WHO was
published only at the end of August 2014 \cite{whositrep}, 
reporting on cases between January and August 2014. On the other
hand, the first post on ProMED on Ebola cases in Guinea appeared in
March 2014 \cite{pmfirstebola}. Development of tools that can directly be
plugged into the current digital surveillance ecosystem should therefore
be a growing area of focus.

In general, we found that, after systematic processing to remove
inconsistencies, data from ProMED and HealthMap were in
\sangeeta{reasonably} good agreement
with the data collated by WHO through traditional surveillance methods.
In particular, both the incidence time-series and retrospective national
estimates of transmissibility over time were well correlated across the
three data sources. This suggests that digital surveillance data are a
promising avenue for quantitative assessment of
outbreak dynamics in real-time. 

We used the ProMED/HealthMap data to perform a spatio-temporal analysis
of the spread of the West African Ebola epidemic. We fitted a spatially
explicit branching process model to the daily incidence data derived
from ProMED/HealthMap feeds. The estimated model parameters were used to
simulate the future outbreak trajectory over 4, 6 or 8 weeks. The model
performs relatively well at short forecast horizon, i.e.~up to
two weeks. At a
longer time scale, the model performance starts to deteriorate. A likely
explanation for this is that our model assumes that transmissibility
remains constant over the entire projection window. This assumption may
not hold as we project over longer horizons, for example due to
interventions being implemented. Model performance was also highly
dependent on the phase of the epidemic in which projections were made.
During the growing phase, the model tended to over-predict. This is
likely due to interventions implemented throughout the growing phase to
reduce transmissibility, leading to a reduced observed incidence
compared to our model's expectation. In the declining phase on the other
hand, our model tended to under-predict the observed incidence. This
could be due to control efforts being relaxed too early as case
numbers decline. Another contributing factor could be super-spreading,
a phenomenon observed in many
epidemics including Ebola epidemics \cite{lau2017spatial,
  agua2016exposure}
whereby a small number of cases generate a large
number of secondary infections, implying that when case numbers are
small, epidemic trajectory may be difficult to predict and not well
described by Poisson likelihood. Models using more complex likelihoods,
e.g.~using Negative Binomial distributions, should be explored in future
work, but will present additional challenges as analytical results
underpinning the estimation of the reproduction number will no longer
hold \cite{cori2013new}.

Such variability in model performance throughout an epidemic could have
important implications if the model predictions are used to inform
resource allocation. Model estimates should therefore be interpreted
with caution, particularly as an outbreak is observed to be declining,
and if the forecast horizon is long.

We have shown that our model would have been
able to accurately predict in real-time the international spread of
Ebola in West Africa. Importantly, our
model has very high sensitivity, predicting all instances of observed
international spread 1 to 4 weeks in advance. Choosing a cut-off to
maximise sensitivity led to low model specificity. On occasions the
model predicted cases in countries, such as Côte d'Ivoire, where
ProMED did not report any case.
However this may also be due to imperfect case reporting. Thus our
method could be used with a high cut-off as a highly sensitive
surveillance system with an alert triggering further epidemiological
investigations \sangeeta{and implementation of epidemic preparedness measures}. 

A key feature of our model is that it
provides, for each country identified as at risk, a map of where the
risk comes from. Out of 5 observed instances of international spread
of Ebola in West Africa, our model correctly identified the source
of importation in 4 cases while in the remaining case, the model
highlighted the source of importation while assigning it low relative
risk. This could help translating data collected through
digital surveillance into concrete operational outputs in real-time
that could assist in epidemic management and control. 

\sangeeta{The systematic collection, storage, organization and communication 
of disease surveillance data were especially challenging during the 
West African Ebola epidemic as the 
deficiencies in transportation and communication resources, 
surveillance data quality and management, human resources and 
management structures posed unique challenges in this context \cite{boland2017overcoming}.
The collection of case
incidence data and rapid dissemination through digital surveillance
systems was further hampered by the limited information technology and internet 
service. Thus, }
for the West African Ebola epidemic, ProMED and HealthMap data were
available at a coarse spatial scale with the \sangeeta{sub-national} level information
for cases missing in most of the records. This limited our analysis to
the spread of the outbreak across national borders only, although
\sangeeta{in principle} our
model could deal with data at any spatial scale. \sangeeta{Both ProMED and HealthMap
collect more granular data for most outbreaks, utilizing these data
to investigate outbreaks and regions would provide further evidence of
the ability of digital surveillance data to usefully complement data
collected from traditional
surveillance. Another}  interesting research
avenue would be to explore ways of integrating
timely data from ProMED and HealthMap with delayed data from ground
surveillance \sangeeta{ to generate timely insights into the spatial spread
  of an outbreak}.


The framework presented in this paper was developed as a
proof-of-concept to use digital surveillance data for near real-time
forecasting of the spatio-temporal spread of an outbreak. It has been
implemented as a web-based tool called ``Mapping the Risk of
International Infectious Disease Spread'' (MRIIDS) (see
\cite{mriidswiki} for more information). To further develop such
approaches, it is important to establish an automated pipeline from data
collection to curation to analysis, which currently requires manual
intervention at each of these steps. Another factor that could enhance
the usability of our model in near real time is to improve the running
time of the fitting and forward simulation. In the current
implementation, the running time varies from approximately 0.5 CPU hours when
100 days of incidence data are being used to approximately 335 CPU hours
using 462 days of incidence data using a 3.3 GHz Intel Xeon X5680
processor. Although the West African Ebola epidemic was of unusual scale
and duration, there is a scope for optimising the model implementation.

Importantly, many other open data sources could be included in our
framework to improve model performance. For example, data on human
mobility could be used to further inform the parametric form and
parameter values of our mobility model. When relevant,
spatially-explicit data on population-level immunity to the circulating
pathogen (e.g.~following previous epidemics and/or due to vaccination)
could also be used to refine our transmission model. Finally,
quantitative information on the performance of health systems and the
ability of regions or countries to respond to an epidemic
\cite{healthsites}, \cite{maina2019spatial} could also be accounted for
in future iterations of the model. \sangeeta{Here using a relatively simple
modelling approach we provide one of the first pieces of evidence of the potential
value of digital surveillance for real-time quantitative analysis of
epidemic data, with important operational and actionable outputs.}


\subsection*{Figures}\label{figures}

\begin{figure*}
\includegraphics{{../../ms-figures/2019-10-25_who-hm-promed-comparison}.pdf}
\caption{Comparison of national daily
incidence trends and R estimates from ProMED, HealthMap and WHO data for
Guinea, Liberia and Sierra Leone. (A) Daily incidence derived from
ProMED (blue), HealthMap (green) and WHO data (orange). Daily incidence
that were not directly available from ProMED and HealthMap data and
which were therefore imputed (see Methods) are shown in lighter shade of blue
and green respectively. WHO data were aggregated to country level. The
y-axis differs for each plot. (B) The median time-varying reproduction
number \(R_t\) estimated using the WHO data (orange), ProMED (blue) and
HealthMap (green) data. The shaded regions depicts the 95\% credible
intervals (95\% CrI) for the \(R_t\) estimates. The reproduction
number was estimated on sliding windows of 28 days, using the R package
EpiEstim \cite{cori2013new}. Estimates shown at time \(t\) are for the
28-day window finishing on day \(t\).}
\end{figure*}

\begin{figure*}
\includegraphics{{../../ms-figures/projections-viz-fixed-country-15-1.ProMED_14_28}.pdf}
\caption{Observed and predicted
incidence, and reproduction number estimates from ProMED data. The top
panel shows the weekly incidence derived from ProMED data and the 4
weeks incidence forecast on log scale. The solid dots represent the
observed weekly incidence where the light blue dots show weeks for which
all data points were obtained using interpolation. The
projections are made over 4 week windows, based on the reproduction
number estimated in the previous 2 weeks. The middle figure in each
panel shows the reproduction number used to make forecasts over each 4
week forecast horizon. The bottom figure shows the effective
reproduction number estimated retrospectively using the full dataset up
to the length of one calibration window before the end.
In each case, the solid black line is the median estimate and
the shaded region represents the 95\% Credible Interval. The red
horizontal dashed line indicates the \(R_t = 1\) threshold. Results are
shown for the three mainly affected countries although the analysis was
done jointly using data for all countries in Africa.}
\label{fig:pm24}
\end{figure*}


\begin{figure*}
\includegraphics{{../../ms-figures/forecasts-assess-viz-26-1.ProMED_14_28_assess}.pdf}
\caption{Model performance metrics overall and stratified by
week of projection and epidemic phase. The performance metrics 
are bias (A), sharpness (B), the percentage of weeks for which the 95\% forecast interval
contained the observed incidence (C), and relative mean absolute error
(D, shown on log scale).
In forecasting ahead, we assumed
transmissibility to be constant over the forecast horizon. If the 97.5\textsuperscript{th}
percentile of the R estimate used for forecasting was less than 1, we
defined the epidemic to be in the declining phase during this period.
Similarly, if the 2.5th percentile of R was greater than 1, we defined
the epidemic to be in a growing phase. The phase was set to stable
where the 95\% Credible Interval of the R estimates contained 1. See
Methods for definitions of each metric.}
\label{fig:perfpm24}
\end{figure*}

\begin{figure*}
\includegraphics{{../../ms-figures/ProMED_roc_alerts_14}.pdf}
\caption{Predicted weekly presence of cases in
each country. The left panel shows the True and False alert rates using
different thresholds for classification when forecasting ahead for 4
(blue), 6 (dark pink), or 8 (light pink) weeks. For a given threshold (\(x^{th}\)
percentile of the forecast interval), we defined a True alert for a week
where the \(x^{th}\) percentile of the forecast interval and the
observed incidence for a country were both greater than 0; false alert
for a week where the threshold for a country was greater than 0 but the
observed incidence for that country was 0; and missed alert: week where
the threshold for a country was 0 but the observed incidence for that
country was greater than 0. True alert rate is the ratio of correctly
classified true alerts to the total number of true and missed alerts
(i.e., (true alerts)/(true alerts + missed alerts)). False alert rate is
similarly the ratio of false alerts to the total number of false alerts
and weeks of no alert (where the observed and the threshold incidence
are both 0). The right panel shows the True (green), False (orange) and
Missed (red) alerts using the 50\textsuperscript{th} percentile of the
forecast interval as threshold. The figure only shows countries on the
African continent for which either the 50\textsuperscript{th}
percentile of the predicted incidence or the
observed incidence was greater than 0 at least once. The x-axis shows
the date on which forecasts were made. For each country,
four rows are shown corresponding to the 1, 2, 3 and 4 week ahead
predictions respectively. The first alert in each country is shown
using larger symbols (square or triangle). Alerts in a country in a
week where there were no observed cases in the previous week are shown
using hollow triangles. Country codes, shown on the y-axis, are as
follows: BEN - Benin, BFA - Burkina Faso, CIV - Côte d'Ivoire, CMR -
Cameroon, COD - Democratic Republic of Congo, GIN - Guinea, GNB -
Guinea-Bissau, LBR - Liberia, MLI - Mali, NER - Niger, NGA - Nigeria,
SEN - Senegal, SLE - Sierra Leone, TGO - Togo. Predictions used here are
using the ProMED data, a 2-week window for inference and a 4 week
forecast horizon.}
\label{fig:alerts}
\end{figure*}


\begin{figure*}
\includegraphics{{../../ms-figures/ProMED_importation_risk_first_obs_14}.pdf}
\caption{Relative risk of importation
of the epidemic. For each country with non-zero incidence, the figure
shows the relative importation risk (see Methods). Since we forecasted
every 7 \textsuperscript{th} day, the risk of importation was estimated
using forecasts closest to and before the date of the first case in that
country reported in the data used. The date on which risk was estimated
for each country is shown in the figure. Blue indicates low relative
risk while deeper shades of red represent higher relative risk of
acting as a source of importation. White is used to denote no risk.
The estimates presented here
use ProMED data with a 2 week window for inference. The country for
which risk is estimated is shown in gray. The black circle represents
the actual source of importation as retrospectively identified through
epidemiological and genomic investigations. For each country, the figure shows only the risk
of importation from other countries and does not show the risk of
transmission within the country.}
\label{fig:imprisk}
\end{figure*}


%\subsection*{Tables}
\subsection*{Supporting Information (SI)}

The following files are provided as Supporting Information: (i) SI
1. Details of ProMED/HealthMap data cleaning and processing, 
model outputs for other data sources, model parameters and
sensitivity analysis. (ii) Convergence report produced by the R
package ggmcmc.


\matmethods{
  \subsection*{Processing ProMED/HealthMap data feed}
  \label{processing-promedhealthmap-data-feed}
We used a set of curated ProMED and HealthMap records on the human cases
of Ebola in West Africa. The dates in the feeds ranged from March 2014
to October 2016. \sangeeta{Each  dataset} recorded the cumulative number of
suspected/confirmed cases and suspected/confirmed deaths by country at
various dates in this period. We derived the country specific daily and
weekly incidence time series from these data after the following data
cleaning and pre-processing:

\begin{itemize}
\item
  We first extracted the total case counts as a sum of suspected and
  confirmed cases (ProMED and HealthMap data did not record probable
  cases \sangeeta{for the West African Ebola epidemic}).
\item
  Each unique record in ProMED is associated with a
  unique alert id. \sangeeta{A alert id can correspond to various reports from
  different sources (news, social media etc.) which might report
  different case numbers. In such cases, we assigned the median of the 
  case numbers to the record.}
\item
  In some instances, cumulative case count was inconsistent in that it
  failed to be monotonically \sangeeta{non-decreasing}. 
  We identified consecutive dates
  (\(t_k\) and \(t_{k + 1}\)) where the cumulative case count was not
  increasing. If removing either \(t_k\) or \(t_{k + 1}\) made the
  cumulative case count increasing, we adopted this option. If however
  removing both or none of them resulted in a increasing series,
  we removed both \(t_k\) and \(t_{k + 1}\). These rules were applied
  iteratively until the cumulative case count was consistent.
\item
  \sangeeta{If an inconsistent point was at the end of the the cumulative case
  series, applying the above rules led to the removal of a large
  number of points. Hence,} to remove outliers at the end of , we used
  Chebyshev inequality with sample mean \cite{saw1984chebyshev}. Given a
  set of observations \(X_1, X_2 \dots X_n\), the formulation of
  Chebyshev inequality by Saw et al.~gives the probability that the
  observation \(X_{n+1}\) is within given sample standard deviations of
  the sample mean. We defined \(X_{n + 1}\) to be an outlier if the
  probability of observing this point given observations
  \(X_1, X_2 \dots X_n\) is less than 0.5. Fixing this probability
  allowed us to determine \(k\) such that $Pr(\mu - k
  \sigma \leq X\_\{n + 1\} \leq \mu + k \sigma) \geq 0.5$, where
  \(\mu\) and \(\sigma\) are the sample mean and sample standard
  deviation respectively. We deleted an observation \(X_{n + 1}\) as an
  outlier if it did lie in this interval.

\item
  Finally, cumulative incidence on days with no records was filled in
  using log-linear interpolation.
\end{itemize}

An example of the pre-processing of ProMED feed is presented in the
supplementary text (SI Figure 1).

\subsection*{Data collated by WHO}\label{data-collated-by-who}

We used the \sangeeta{West African Ebola} incidence data collated by the WHO during the 
epidemic \sangeeta{which was} made available by \cite{garske20160308}
\sangeeta{approximately an year after the end of the epidemic}, referred to as
the ``WHO data'' in the interest of brevity. The cleaned version of the
WHO data consisted of cases reported between December 2013 and October
2015 in the three most affected countries - Guinea, Sierra Leone and
Liberia. The location of residence of cases was geo-coded to the second
administrative level. We aggregated the WHO data to national level to
match the spatial resolution of ProMED and HealthMap that were only
available at the country level.

\subsection*{Demographic Data}\label{demographic-data}

We used LandScan\textsuperscript{TM} 2015 dataset grid \cite{landscan}
for population estimates and centroids for all countries on African
mainland.

\subsection*{Statistical model}\label{statistical-model}

Our model relies on a well-established statistical framework that
assumes the daily incidence, \(I_t\) , can be approximated with a
Poisson process following the renewal equation
\cite{fraser2007estimating}:

\begin{equation*}
  I_{t} \sim 
  Pois
  \left( 
    R_t \sum_{s = 1}^{t}{I_{t - s}\omega_s}
  \right).
\end{equation*}

Here \(R_t\) is the reproduction number at time \(t\) (the average
number of secondary cases per infected individual) and \(\omega\) is the
distribution of the serial interval (the time between onset of symptoms
in a case and their infector).

We extend this model to incorporate the spatial spread of the outbreak
between \(n\) different locations. The number of incident cases at a
location \(j\) at time \(t\) is given by the equation

\begin{equation}
  I_{j}^{t} \sim 
  Pois\left( 
  \sum_{i = 1}^{n} 
  {\left( p_{i \rightarrow j}
  R_{i}^{t} \sum_{s = 1}^{t}{I_{i}^{t - s} \omega_{s}}
  \right)} 
  \right),
  \label{eq:likelihood}
\end{equation}

where \(R_{i}^{t}\) is the reproduction number at location \(i\) at time
\(t\) and \(p_{i \rightarrow j}\) is the probability of a case moving
from location \(i\) to location \(j\) while they are infectious.
\(R_{i}^{t}\) is affected by a number of factors e.g., the intrinsic
transmissibility of a pathogen or the health care capacity at location
\(i\) (which could influence for example the capacity to isolate cases).
The model could be easily extended to explicitly incorporate the
dependence of the reproduction number on such factors.

The probability of moving between locations is derived from the relative
flow of populations between locations. This latter quantity can be
estimated using a population flow model; here we used a gravity model
\cite{grosche2007175}, \cite{zipf1946p}. Under a gravity model, the flow
of individuals from area \(i\) to area \(j\),
\(\phi_{i \rightarrow j}\), is proportional to the product of the
populations of the two locations, \(N_i\) and \(N_j\) and inversely
proportional to the distance between them \(d_{i, j}\), with all
quantities raised to some power: 
\begin{equation*}
  \phi_{i \rightarrow j} =  \frac{N_iN_j}{d_{i, j}^{\gamma}}.
\end{equation*}

The exponent \(\gamma\),
which modulates the effect of distance on the flow of populations, was
estimated. A large value of \(\gamma\) indicates that the distances
travelled by populations tend to be short.

The relative risk of spread at a location \(j\) from a location \(i\) is
thus proportional to the population flow into location \(j\) from
location \(i\).

\begin{equation*}
  r_{i \rightarrow j}^{spread} = \frac{\phi_{i \rightarrow
  j}}{\sum\limits_{x, x \neq i}{\phi_{i \rightarrow
  x}}}.
\end{equation*}

The probability of movement from location \(i\) to location \(j\)
where ($j \neq i$)is
then given by 
\begin{equation*} 
p_{i \rightarrow j} = (1 - p_{stay}) r_{i \rightarrow j}^{spread},
\end{equation*}

where \(p_{stay}\) is the probability that a case remains in a location
\(i\) throughout their infectious period i.e. $p_{stay}$ is $p_{i
  \rightarrow i}$. \(p_{stay}\) is assumed to be
the same across all locations.

The parameters of the full model are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \(R_{i}^{t}\), the reproduction number at time \(t\) in location
  \(i\),
\item
  \(p_{stay}\), the probability of staying in a location, and
\item
  \(\gamma\), the exponent of the distance in the gravity model.
\end{enumerate}

The likelihood of the incidence at time \(t\) in location \(j\) given
past incidence across all locations and model parameters is:

\begin{equation*}
  \begin{aligned}
P ( 
I_{j}^{t} \mid 
& p_{stay}, \gamma, \omega, \\
& {\langle R_{i}^{0} \rangle}_{\{i = 1, 2, \dots n\}}, \hdots, {\langle R_{i}^{t} \rangle}_{\{i = 1, 2, \dots n\}}, \\
& {\langle I_{i}^{0} \rangle}_{\{i = 1, 2, \dots n\}}, \hdots {\langle I_{i}^{t-1} \rangle}_{\{i = 1, 2, \dots n\}} ) \\
& =  e^{-\Lambda_{j}^{t}}  \frac{ {\left( I_{j}^{t}\right)}^{\Lambda_{j}^{t}}}{\Lambda_{j}^{t} !}.
\end{aligned}
\end{equation*}

\({\langle R_{i}^{t} \rangle}_{\{i = 1, 2, \dots n\}}\) is the set of
reproduction numbers at time \(t\) in locations \(1, 2, \dots n\).
\({\langle I_{i}^{t} \rangle}_{\{i = 1, 2, \dots n\}}\) is similarly the
incidence at time \(t\) in locations \(1, 2, \dots
n\). \(\Lambda_{j}^{t}\) is given by

\begin{equation}
\Lambda_{j}^{t} = \sum\limits_{i = 1}^n{\left(p_{i \rightarrow j}R_{i}^{t} \sum_{s
        = 1}^t{I_{i}^{t - s} \omega_{s}} \right)}.
\label{eq:lambdajt}
\end{equation} 

The likelihood of the parameters for data \sangeeta{up to time $T$, the duration
of the outbreak so far}, is

\begin{equation*}
  \mathcal{L} = P
  \left(
    {\langle I_{j}^{t} \rangle}_{j = 1, 2 \dots n}^{t = 1, 2, \dots T} \mid
    p_{stay},
    \gamma,
    {\langle R_{j}^{t} \rangle}_{j = 1, 2 \dots n}^{t = 1, 2, \dots T}\right) = 
     \prod_{t = 1}^{t}{e^{-\Lambda_{i}^{t}} 
       \frac{\left(I_{i}^{t}\right)^{\Lambda_{i}^{t}}}{\Lambda_{i}^{t} !}}.
  \end{equation*}

Therefore the joint posterior distribution of the model parameters 
given the observed data is:

\begin{equation*}
  \begin{aligned}
  & P\left(p_{stay}, \gamma, {\langle R_{j}^{t}\rangle}_{j = 1, 2, \dots n}^{t = 1, 2, \dots T}
   \mid 
   \langle I_{j}^{t}\rangle_{j = 1, 2, \dots n}^{t = 1, 2, \dots T} \right)
   \propto  \\
   & \mathcal{L} \times 
   P\left(\langle R_{j}^{t}\rangle_{j = 1, 2, \dots n}^{t = 1, 2, \dots T}\right) 
   P\left( p_{stay} \right) P\left( \gamma \right).
   \end{aligned}
\end{equation*}


\(P\left( p_{stay} \right)\), \(P\left( \gamma \right)\), and
\(P\left(\langle R_{j}^{t}\rangle_{j = 1, 2, \dots n}^{t = 1, 2, \dots T}\right)\) represent
the prior distributions on the parameters.

Here, we have assumed a single \(p_{stay}\) for all countries on African
mainland. For estimating the time-varying reproduction number for each
country, we split the duration of the total outbreak into intervals of
equal width. We assume that transmissibility in each location stays
constant within each time window and thus, within a time window, we
estimated a single reproduction number for each location. 
We varied the length of the time window to obtain different models, with short time
windows increasing the number of parameters in the model. 
To reduce
the number of parameters in the model, we divided the 55 countries on
African continent into 5 groups and estimated a reproduction number
for each group in each time window. The first three groups correspond
of the three mainly affected countries - Sierra Leone, Guinea and Liberia.
The countries that shared a border with these three countries
were grouped together. These were Mali, Côte d'Ivoire, Guinea-Bissau
and Gambia. The rest of the countries were assigned to the fifth group.
A comparison
of the performance of different models is presented in the Supplementary
Material (SI Fig \ref{fig:perftw}).

We assumed a Gamma distributed serial interval with mean 14.2 days and
standard deviation 9.6 days \cite{team2015west}. For the reproduction
number, we used a Gamma prior with mean 3.3 and variance 1.5. This was
informed by a review of estimates of the reproduction number for Ebola
Zaire in outbreaks preceding the West African Ebola outbreak which
reported estimates ranging from 1.4 to 4.7 \cite{van2015review}. The
mean prior 3.3 was chosen as the midpoint of this interval, and the
variance 1.5, was chosen so the 95\% prior probability interval contains
the extremes of this interval.

For the gravity model parameters \(p_{stay}\) and \(\gamma\), we chose
uninformative uniform priors. Since \(p_{stay}\) is a probability, the
prior was a uniform distribution on the interval \([0, 1]\). For
simplicity, and in the absence of data to inform these, we assumed the
exponents \(\alpha\) and \(\beta\) on the populations to be 1.
\(\gamma\) was allowed to vary between 1 and 2 in the results presented
in the main text. We performed a sensitivity analysis where \(\gamma\)
has a uniform prior between 1 and 10. The results of this analysis are
presented in the SI (SI Section \ref{sec:sensitivity-analysis}).

Model fitting was done in a Bayesian framework using a Markov Chain
Monte Carlo (MCMC) as implemented in the software Stan
\cite{carpenter2017stan} and its R interface rstan \cite{rstan}. We ran
2 MCMC chains with 3000 iterations and burn-in of 1000 iterations.
Convergence of MCMC chains was confirmed using visual inspections of the
diagnostics (Potential Scale Reduction Factor \cite{gelman1992inference}
and Geweke Diagnostics \cite{geweke}) reported by R package ggmcmc
\cite{ggmcmc}. An example report produced by ggmcmc is included in the
Supplementary Material.

For each model (i.e., for each choice of the time window), we made
forward projections every 7\textsuperscript{th} day, over a 2 week, 4
week and 6 week horizon. To forecast incidence from day \(t\) onwards,
we fitted the model to the daily incidence series up to day \(t-1\). We
then sampled 1000 parameter sets (reproduction numbers for each location
in each time window and parameters of the gravity model) from the joint
posterior distribution, and for each parameter set, simulated one future
epidemic trajectory according to equation (1), assuming that future
\(R_t\) is equal to the last estimated \(R_t\) value in each location.

\section*{Model Validation}\label{assess}

Given the retrospective nature of our analysis, we validated the
incidence projected using our model against observed incidence. In
addition to the \sangeeta{accuracy} of the projected incidence, the uncertainty
associated with the forecasts (e.g., measured by the width of the
prediction interval) is an important indicator of model performance. A
narrow prediction interval that contains the observed values is
preferable over wide prediction intervals. To assess the performance of
the model along both these dimensions, we used four different metrics
drawn from the literature.

In the remainder of this paper, we use the following notation. For a
location \(j\), let \(I_{j}^{t}\) be the observed incidence at time $t$
and let $\hat{I}_{j}^{t}$ be the set of predictions of the
model at time \(t\). That is, $\hat{I}_{j}^{t}= \{\hat{I}_{j}^{t, 1}, \hat{I}_{j}^{t, 2}, \dots \hat{I}_{j}^{t,N}\}$
is the set of \(N\) draws from the Poisson distribution with mean
\(\Lambda_{j}^{t}\) (Equation 1) (here N = 1000).



\subsection*{Relative mean absolute error}\label{relative-mean-absolute-error}

The relative mean absolute error (rmae) is a widely used measure of
model accuracy \cite{tofallis2015better}. The relative mean absolute
error for the forecasts at a location \(j\) at time \(t\) is defined as:

\begin{equation*}
  rmae_{j}^{t}(I_{j}^{t}, \hat{I}_{j}^{t}) = 
 \frac{
 \sum_{s = 1}^N{\lvert I_{j}^{t} - \hat{I}_{j}^{t, s} \rvert}
 }
 { N *  (I_{j}^{t} + 1)}.
\end{equation*}

That is the mean absolute error at time \(t\) is averaged
across all simulated incidence trajectories and normalised by the
observed incidence. We add \(1\) to the observed value to prevent division
by \(0\). A rmae value of \(k\) means that the average error is \(k\)
times the observed value.

\subsection*{Sharpness}\label{sharpness}

Sharpness is a measure of the spread (or uncertainty) of the forecasts.
Adapting the definition proposed by \cite{funk2017assessing}, we used
the relative mean deviation about the median to evaluate
sharpness. The sharpness $s_{j}^t$ of forecasts at at time \(t\)
at location \(j\) is

\begin{equation*}
s_{j}^{t}(\hat{I}_{j}^{t}) = 
mean 
\left(
\frac{\lvert \hat{I}_{j}^{t, s} - median(\hat{I}_{j}^{t}) \rvert} 
{median(\hat{I}_{j}^{t})} 
\right).
\end{equation*}

We add 1 to \(\hat{I}_{j}^{t}\) to prevent division by 0. A sharpness
score of \(k\) indicates that the average deviation of the predicted
incidence trajectories is \(k\) times their median. Low values of
sharpness therefore suggest that the predicted trajectories are
clustered around the median.


\subsection*{Bias}\label{bias}

The bias of forecasts is a measure of the tendency of a model to
systematically under- or over-predict \cite{funk2017assessing}. The bias
of a set of predictions $\hat{I}_{j}^{t}$ at time \(t\) at
location \(j\) is defined as

\begin{equation*}
b_{j}^{t}(I_{j}^{t}, \hat{I}_{j}^{t}) = 
2 \left( mean \left( H \left (\hat{I}_{j}^{t, s} - I_{j}^{t} \right)
\right) - 0.5 \right),
\end{equation*}

where the mean is taken across the \(N\) draws. \(H(x)\) is the Heaviside
step function defined as

\begin{equation*}
H(x) = \begin{cases} 
0 & \text{ if } x < 0 \\ 
1 & \text{ if } x > 0 \\
0.5 & \text{ if } x = 0. 
\end{cases} 
\end{equation*}

The above formulation can better be understood by considering the
following extreme scenarios. If every projected value
$\hat{I}_{j}^{t}$ is greater than the observed value
$I_{j}^{t}$, then the Heaviside function is 1 for all $i = 1, 2,
\dots N$, and 
\[ mean\left( H \left( \hat{I}_{j}^{t} - I_j^t \right) \right) \]
is 1. The bias for a model that always over-predicts
is therefore 1. On the other hand, if the model systematically
under-predicts, then
\[ mean\left( H \left( \hat{I}_{j}^{t} - I_j^t \right) \right) \]
is 0 and the bias is -1. For a model for which all
predictions match the observed values exactly, the bias is 0.


\section*{Code and data availability}
All analysis was carried out in the statistical software R version
3.5.3. The code for analysis of ProMED and HealthMap data and an
implementation of the model is available at
\url{https://github.com/annecori/mRIIDSprocessData}. The code for
producing the text and figures for this manuscript is available at
\url{https://github.com/sangeetabhatia03/mriids_manuscript}. This
repository also contains the raw and processed data. Implementation
of model performance metrics is at
\url{https://github.com/sangeetabhatia03/assessR}.

\section*{Relative risk of
  importation}\label{relative-risk-of-importation}

The total infectivity $\Lambda_{j}^{t}$ at a location $j$ at time $t$ is the sum of
infectivity at all locations weighted by the relative flow of cases
into $j$ from each location $i$ (Eq \ref{eq:lambdajt}). We define the risk of
importation of case from $i$ into $j$ as the proportion of infectivity
at $j$ due to infectivity at $i$. That is, 

\begin{equation*}
r_{j \leftarrow i}^{import}(t) = \frac{\lambda_i^t}{\Lambda_j^t},
\end{equation*}

where $\Lambda_j^t$ is as in Eq~\ref{eq:lambdajt}, and
$\lambda_i^t = R_{i}^{t} \sum\limits_{s =1}^{t} {I_{i}^{t - s}\omega_{s}}$.

} %% end of matmethods

\showmatmethods{} % Display the Materials and Methods section

\acknow{The work in this manuscript was funded through the USAID
  (United States Agency of International Development ) Center for
  Accelerating Innovation and Impact - ``Combating Zika and Future
  Threats: A Grand Challenge for Development'' Program (Award
  No. AID-0AA-F-16-00115). The contents of
  the manuscript are solely the responsibility of the authors and do
  not necessarily represent the official views of the USAID. We
  acknowledge joint Centre funding from the UK Medical Research
  Council and Department for International Development.}

\showacknow{} % Display the acknowledgments section

% Bibliography
\bibliography{mriids}

\end{document}