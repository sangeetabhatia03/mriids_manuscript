# Results

## Cleaning ProMED/HealthMap data feed
A set of curated ProMED and HealthMap records on the human cases of 
Ebola in West Africa from ProMED were provided to the modeling
team. The dates in the feed ranged from March 2014 to October 2016.
The data set recorded the cumulative number of suspected/confirmed
cases and suspected/confirmed deaths in this period. 
The raw data from ProMED is shown in Figure \@ref(fig:hmraw)

```{r hmraw, echo = FALSE, fig.cap = "Raw data from ProMED", fig.align = "center"}
knitr::include_graphics("ms-figures/promed_raw.png")
```
We derived the daily and weekly incidence series from these data after 
data cleaning and pre-processing. We first extracted the total case
counts as a sum of suspected and confirmed cases. Each unique record 
in ProMED/HealthMap data is associated with a unique alert id.  Where
multiple records were associated with the same alert id, we merged
them by assigning the median of the case numbers to the record. In
some instances, cumulative case count was inconsistent in that it
failed to be monotonically increasing. These records were further 
removed.  Finally, missing data was filled in using linear or log-linear
interpolation. Results at each step pre-processing workflow for Guinea
are shown in Figure \@ref(fig:hmclean). Further details of each step
are presented in the supplementary text.


```{r hmclean, echo = FALSE, fig.cap = "Data clean-up steps", fig.align = "center"}
knitr::include_graphics("ms-figures/promed_Guinea.png")
```

## Comparison of incidence trends from different sources

We compared the incidence series derived from ProMED and HealthMap
data with the, data collated by WHO during this outbreak made
available by [@garske20160308]. Throughout the rest of this document, 
we refer to this data set as WHO data in the interest of brevity.
The results are shown in Figure \@ref(fig:incidcompare)

```{r incidcompare, echo = FALSE, fig.cap = "Comparison of daily incidence trends derived from ProMED, HealthMap and WHO data. The three time series exhibit a high degree of correlation.", fig.align = "center"}
knitr::include_graphics("ms-figures/who_promed_hm_incid.png")
```

Figure \@ref(fig:rcompare) compares the reproduction number estimated 
from the respective incidence series. The instantaneous reproduction
number was estimated in R using the package EpiEstim [@cori2013new]. 
As expected, the estimated reproduction numbers are highly correlated.


```{r rcompare, echo = FALSE, fig.cap = "Comparison of daily incidence trends derived from ProMED, HealthMap and WHO data. The three time series exhibit a high degree of correlation.", fig.align = "center"}
knitr::include_graphics("ms-figures/who_promed_hm_r.png")
```


## Short term projections

We assumed a Gamma distributed serial interval with mean 14.2 
days and standard deviation 9.6 days [@team2015west]. 
For the reproduction number, we used a Gamma prior with mean 
3.3 and variance 1.5. This was informed by a review of 
estimates of the reproduction number for Ebola Zaire in 
outbreaks preceding the West African Ebola outbreak which 
reported estimates ranging from 1.4 to 4.7 [@van2015review]. 
The mean prior 3.3 was chosen as the midpoint of this interval, 
and the variance 1.5, was chosen so the 95% prior probability
interval contains the extremes of this interval.

For gravity model parameters \(p_stay\) and \( \gamma\), we choose
uninformative uniform priors. Since \(p_stay\) is a probability
the prior was a uniform distribution on the interval \([0, 1]\).
\( \gamma \) was allowed to vary between 1 and 3.

Model fitting was done in a Bayesian framework using MCMC
methods as implemented in the software Stan [@carpenter2017stan] 
and its R interface rstan [@rstan]. For projecting the incidence
beginning at day \(T\), we fitted the model to the daily
incidence series derived from ProMED/HealthMap data up to day
\( T - 1\). Transmissibility was assumed to stay constant in the
time frame over which we were projecting. Samples from the 
posterior distribution for the effective reproduction
number estimated in the last time window before the point of
projection were used for projections. Similarly samples from the
posterior distribution for \( \gamma \) and \( p_{stay} \) were
used to estimate the relative flow.

Figures \@(fig:guinea49, fig:liberia49, fig:sl49) show the
non-overlapping weekly forecasts for 4 weeks from the point of 
projection where effective 
reproduction number is being estimated for each 4 week window 
up to the point of projection. Results from the model using
1 week and 3 weeks time window are presented in the supplementary 
text. In each figure, panel (A) shows the projected weekly 
incidence overlaid on the observed weekly incidence. The middle 
panel shows the posterior distribution of the reproduction
number used for projection in the corresponding time frame. This
estimate uses only data available up to the point at which we
begin projecting forward. The last panel (C) in each figure 
shows the reproduction number estimated using all available data.


```{r guinea49, echo = FALSE, fig.cap = "(A) Weekly observed and predicted incidence in Guinea at different points during the outbreak. The reproduction number was estimated for each 4 week interval up to the point at which projection is done. (B) Effective reproduction number estimated in real-time using (C) Effective reproduction number estimated retrospectively.", fig.align = "center"}
knitr::include_graphics("ms-figures/GIN_21_637_14_28.png")
```


```{r liberia49, echo = FALSE, fig.cap = "Weekly observed and predicted incidence in Liberia at different points during the outbreak. The reproduction number was estimated for each 4 week interval up to the point at which projection is done. (B) Effective reproduction number estimated in real-time using (C) Effective reproduction number estimated retrospectively.", fig.align = "center"}
knitr::include_graphics("ms-figures/LBR_21_637_14_28.png")
```


```{r sl49, echo = FALSE, fig.cap = "Weekly observed and predicted incidence in Sierra Leone at different points during the outbreak. The reproduction number was estimated for each 4 week interval up to the point at which projection is done. (B) Effective reproduction number estimated in real-time using (C) Effective reproduction number estimated retrospectively.", fig.align = "center"}
knitr::include_graphics("ms-figures/SLE_21_637_14_28.png")
```

Figure \@(fig:pstayandgamma) shows how the estimated values of 
the parameters of the mobility model changed over the course of
the outbreak. Both these parameters were assumed to be constant
for the time frame over which model was fitted. It is interesting
to note that the change in estimated indicates decreased probability
of travel across national borders.

```{r pstayandgamma, echo = FALSE, fig.cap = "Estimates of mobility parameters at different points during the outbreak. The circle represents the central estimate and the horizontal bars reflect the 2.5 and 97.5 percentiles."}
knitr::include_graphics("ms-figures/gamma_pstay_over_tproj.png")
```
## Evaluation of the model performance

Figure \@ref(fig:assess) shows the metrics (bias,
sharpness, log of relative accuracy, and relative mean absolute error) 
discussed in Section \@ref{assess} for the 4 week projections in 
Guinea, Sierra Leone and Liberia using a 4-week window to estimate
reproduction number. Each metric was first computed using the daily
observed and predicted series and then averaged for each week of
projections.

Across all metrics, there is a strong trend of decreased model
performance as the forecast horizon increases. The bias in forecasts
at week 1 is closer to 0 at every time point. Similarly the forecasts
at week 1 are more sharp (sharpness close to 0) than at week 4. In
general, the model performs better in the growing phase of the
epidemic (defined as the window in which the 0.025th percentile of the
posterior distribution is greater than 1). In this phase, the
forecasts are generally greater than the observed incidence while in 
the descending phase (defined similarly as the window in which the 
0.975th percentile is less than 1), the model under-predicts. The
length of the calibration window did not have a significant impact on 
the model performance.




```{r assess, echo = FALSE, fig.cap = "Metrics for evaluating model performance.", fig.align = "center"}
knitr::include_graphics("ms-figures/forecasts_assess_28.png")
```
