# Methodology
The underlying model relies on a well-established and simple framework 
that assumes the daily incidence, \(ùêº_t \) , can be approximated with a
Poisson process following the renewal equation
[@fraser2007estimating]. 

\[
  I_{j, t} \sim 
  Pois
  \left( 
    R_t \sum_{s = 1}^{t}{I_{t - s}\omega_s}
  \right).
\]

Here \(R_t\) is the reproduction number at time \(t\) and \(\omega\)
is the distribution of the serial interval. 

We build on this model to incorporate the spatial spread of the
outbreak between  \( n \) different locations.
The number of cases at a location \(j\) at time \(t\) is given by the equation
\[
  I_{j, t} \sim 
  Pois\left( 
  \sum_{i = 1}^{n} 
  {\left( p_{i \rightarrow j}
  R_{i, t} \sum_{s = 1}^{t}{I_{i, t - s} w_{s}}
  \right)} 
  \right),
\]

where \(R_{i, t}\) is the reproduction number at location \(i\) at time
\(t\) and \(p_{i \rightarrow j}\) is the probability of moving from
location \(i\) to location \(j\). $R_{t, i}$ is
affected by a number of other factors e.g., the intrinsic
transmissibility of a pathogen, the health care capacity at location
$i$ etc. The model can be easily extended to incorporate the
dependence of the reproduction number on these factors. 

The probability of moving between locations is derived from the
relative flow of populations.
This latter quantity is estimated using a population flow
model such as a gravity model \citep{GROSCHE2007175}. 
Under a gravity model, the flow of individuals from area \(i\) to area \(j\),
\(\phi_{i \rightarrow j}\), is proportional to the product of the
populations of the two areas, \(N_i\) and \(N_j\) and inversely
proportional to the distance between them \(d_{i, j}\), all quantities
are raised to some power.
\[
  \phi_{i \rightarrow j} :=  \frac{N_i^{\alpha}N_j^{\beta}}{d_{i, j}^{\gamma}}.
\]
 The exponent \( \gamma \) modulates the effect of distance on the flow of
populations. A large value of \( \gamma \) indicates that the
distances travelled by populations tend to be short.

The relative risk of spread at a location \(j\) from a location \(i\)
is thus the population flow into location \(j\) from location \(i\).

\[
  r_{i \rightarrow j}^{spread} = \frac{\phi_{i \rightarrow
  j}}{\sum_{x}{\phi_{i \rightarrow
  x}}}.
\]

The probability of movement from location \(i\) to location \(j\) is given by
\[  p_{i \rightarrow j} = (1 - p_{stay}^i) r_{i \rightarrow j}^{spread},\]

where \(p_{stay}^i\) is the probability of staying at location
\(i\). As the above equation indicates, by varying $p_{stay}^i$, we
can capture the dynamics of population flow across spatial units. For
instance, if \(p_{stay}^i\) is large, then the flow out of location
\(i\) would be small. Thus, if this parameter is geographically
heterogeneous, we obtain imbalanced flow of population (i.e. source-sink dynamics). 

\subsection{Statistical inference of model parameters}

The parameters of the full model as presented are: 

1.  \(R_{i, t}\), the reproduction number at time \(t\) in location \(i\),
2.  \(p_{stay}^i\), the probability of staying in location \(i\), and 
3.  \(\gamma\), the exponent of the distance in the gravity model. 

We assumed the exponents \(\alpha \) and \(\beta\) on the
populations to be 1.

The posterior distribution of each parameter are estimated using
MCMC. Let \( o_{k, j} \) be the observed incidence at time \(k\) at location
\(j\). Then the likelihood of the model parameters given the
observations is proportional to the probability of the data given
model parameters.  The probability of $o_{k, j}$ given
the model parameters is:
\[ P(o_{k, j} \mid p_{stay}, \gamma, R_{1, t}, R_{2, t}, \dots , R_{n,
t}) = 
e^{-\lambda_{j, t}}
  \frac{o_{j, t}^{\lambda_{j, t}}}{\lambda_{j, t} !}, \]
where $\lambda_{j, t}$ is given by
\[\lambda_{j, t} = \sum_{i = 1}^n{\left(p_{i \rightarrow j}R_{i, t} \sum_{s
        = 1}^t{I_{i, s}w_{t - s}} \right)}.\]

Thus assuming that each observation is independent, the likelihood of 
the parameters is proportional to
\[\mathcal{L} = P(\{o_{j, t}\} \mid p_{stay}, \gamma, \{R_{i, t}\}) = 
 \prod_{t = 1}^{t}{e^{-\lambda_{i, t}} 
 \frac{o_{i, t}^{\lambda_{i, t}}}{\lambda_{i, t} !}}.\]

Given this likelihood, we can write the joint posterior distribution
of the parameter given the observed data as:

\[P(\{p_{stay}^i\}, \gamma, \{R_{i, t}\} 
   \mid 
   \{o_{j, t}\}) 
   \propto  
   \mathcal{L} \times P(\{R_{i,0}\}) P(\{p_{stay}^i\}) P(\gamma).\]

\(P(\{p_{stay}^i\})\),  \(P(\gamma)\), and \(P(\{R_{i,0}\})\) 
represent the prior distributions on the parameters. The influence of
factors such as healthcare capacity of a location can be incorporated
into the model through the prior distributions. Similarly, the prior
distributions on the probability of staying at a location and the
exponent on distance can be informed by additional data sources 
such as prior information derived from flight data. 

In practice, we have assumed a single \(p_{stay}\) for all 
countries on African mainland. For estimating the time-varying
reproduction number for each country, we split the duration of the
total outbreak into intervals of equal width. We assume that
transmissibility stays constant within each time window and thus,
within a time window, we estimated  a single reproduction number for
each location. We varied the length of this
time window to obtain different models. A short time window increases
the number of parameters in the model and a comparison of the
different models is presented in Section \@ref(results).

